<!DOCTYPE html>
<html>

	<head>

		<script type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js", crossorigi="anonymous"></script>

		<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-eOJMYsd53ii+scO/bJGFsiCZc+5NDVN2yr8+0RDqr0Ql0h+rP48ckxlpbzKgwra6" crossorigin="anonymous">
		
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js" integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf" crossorigin="anonymous"></script>
		
		<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.1/dist/umd/popper.min.js" integrity="sha384-SR1sx49pcuLnqZUnnPwx6FCym0wLsk5JZuNx2bPPENzswTNFaQU1RDvt3wT4gWFG" crossorigin="anonymous"></script>
		
		<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.min.js" integrity="sha384-j0CNLUeiqtyaRmlzUHCPZ+Gy5fQu0dQ6eZ/xAww941Ai1SxSY+0EQqNXNE6DZiVc" crossorigin="anonymous"></script>

		<script src="/socket.io/socket.io.js"node></script>

	</head>

	<body>
		<div class="container">
			<br>
			<div class="jumbotron">
				<h1 class="display-4"> Send Message</h1>
				<br>
				<input id = "name" class="form-control" placeholder="Name">
				<br>
				<textarea id = "message" class="form-control" placeholder="Message"></textarea>
				<br>
				<button id="send" class="btn btn-success">Send</button>

			</div>

			<div id="messages">
				

			</div>
		</div>
		<script>
			var socket = io()

			$(()=> {

				$("#send").click(() => {
					var message = {name: $("#name").val(), message: $("#message").val()}
					postMessage(message)
				})
				getMessages()
			})

			socket.on("message", addMessage)

			function addMessage(message){

				$("#messages").append(`<h4> ${message.name} </h4> <p> ${message.message} </p>`)
			}

			function getMessages() {

				$.get("http://localhost:3010/messages", (data)=> {

					data.forEach(addMessage);
				})
			}

			function postMessage(message) {

				$.post("http://localhost:3010/messages", message )
			}

		</script>
	</body>

</html>